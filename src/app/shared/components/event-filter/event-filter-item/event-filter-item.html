<div class="step-container">
  <div class="step-title">
    <div>
      <span>{{ filter().eventId }}. Step:</span>
      <input class="step-name-input" type="text" [value]="filter().eventName" (change)="onStepNameChange($event.target.value)">
    </div>

    <div class="step-actions">
      <app-button type="tertiary" (click)="onDeleteStep()"><app-icon>delete</app-icon></app-button>
      <app-button type="tertiary" (click)="onCopyStep()"><app-icon>content_copy</app-icon></app-button>
    </div>

  </div>
  <div class="step-filter-container">
    <div class="step-event">
      <app-select-button [options]="eventTypes()" [placeholder]="'Select an event'" [selectedOption]="filter().type ? filter().type! : null" (selected)="onEventTypeSelected($event)"></app-select-button>
    </div>
    <div class="step-attribute-list-container">
      @for(attribute of filter().properties; track $index){
      <div class="step-attribute-item">
        <div class="step-attribute">
          <app-select-button [options]="properties()" [placeholder]="'Select an event'" [selectedOption]="attribute.property ? attribute.property : null" (selected)="onPropertySelected($event, attribute.propertyId)"></app-select-button>
        </div>
        @if(attribute.property){
        <div class="step-operator">
          <app-choice-button [options]="operatorOptions()" [placeholder]="'Select operator'" [selectedOption]="attribute.operator ? attribute.operator.value : null" (selected)="onOperatorSelected($event, attribute.propertyId)"></app-choice-button>
        </div>
        <div class="step-value">
          <!-- <input [type]="attribute.type === 'string' ? 'text' : 'number'" [value]="attribute.value1" (change)="onValue1Change($event.target.value, attribute.propertyId)"> -->
        </div>
        }
      </div>

      }
      @if(filter().type){
      <app-button type="secondary" (click)="onAddNewAttribute()">{{filter().properties && filter().properties!.length > 0 ? 'Refine more' : '+ Add another attribute'}}</app-button>
      }
    </div>
  </div>
</div>
